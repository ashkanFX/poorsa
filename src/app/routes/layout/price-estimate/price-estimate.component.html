<!-- ===== PRICE ESTIMATE BANNER ===== -->
<div class="price-banner-container">
  <div class="price-banner">
    <img src="assets/price/price-banner.jpg" alt="ارزیابی قیمت" class="banner-image" loading="lazy" decoding="async">
  </div>
  <div class="banner-overlay">
    <div class="banner-content">
      <h1 class="banner-title">ارزیابی قیمت</h1>
      <p class="banner-subtitle">محاسبه قیمت نهایی محصولات با تخفیف</p>
    </div>
  </div>
</div>

<!-- ===== PRICE ESTIMATE INTRO ===== -->
<div class="price-intro-section">
  <div class="price-intro-container">
    <div class="breadcrumb">
      <span class="breadcrumb-text">خانه / ارزیابی قیمت</span>
    </div>
    <div class="intro-content">
      <h2 class="intro-title">محاسبه قیمت محصولات</h2>
      <p class="intro-description">
        با استفاده از این ابزار می‌توانید قیمت نهایی محصولات را با در نظر گیری تخفیف محاسبه کنید.
        تعداد کارت‌ها و درصد تخفیف را وارد کنید تا قیمت نهایی محاسبه شود.
      </p>
    </div>
  </div>
</div>

<!-- ===== PRICE CALCULATOR ===== -->
<div class="price-calculator-section">
  <div class="price-calculator-container">
    
    <!-- Product List -->
    <div class="product-list-section">
      <h3 class="section-title">لیست محصولات</h3>
      <div class="product-list">
        <div class="product-item" *ngFor="let product of products; let i = index">
          <div class="product-info">
            <h4 class="product-name">{{ product.name }}</h4>
            <p class="product-description">{{ product.description }}</p>
            <span class="product-price">{{ product.price | currency:'IRR':'symbol':'1.0-0':'fa' }}</span>
          </div>
          <div class="product-controls">
            <div class="quantity-control">
              <label class="control-label">تعداد کارت:</label>
              <div class="quantity-input">
                <button class="quantity-btn" (click)="decreaseQuantity(i)" [disabled]="product.quantity <= 1">-</button>
                <input type="number" 
                       [(ngModel)]="product.quantity" 
                       min="1" 
                       max="10" 
                       class="quantity-field"
                       (input)="updateQuantity(i, $event)">
                <button class="quantity-btn" (click)="increaseQuantity(i)" [disabled]="product.quantity >= 10">+</button>
              </div>
              <div class="quantity-info">
                <span class="info-text">{{ product.quantity }} کارت × {{ product.price | currency:'IRR':'symbol':'1.0-0':'fa' }}</span>
              </div>
            </div>
            <div class="discount-control">
              <label class="control-label">درصد تخفیف:</label>
              <div class="discount-input">
                <input type="range" 
                       [(ngModel)]="product.discount" 
                       min="0" 
                       max="50" 
                       class="discount-slider"
                       (input)="updateDiscount(i, $event)">
                <span class="discount-value">{{ product.discount }}%</span>
              </div>
              <div class="discount-info" *ngIf="product.discount > 0">
                <span class="info-text">تخفیف: {{ ((product.price * product.quantity * product.discount) / 100) | currency:'IRR':'symbol':'1.0-0':'fa' }}</span>
              </div>
            </div>
            <div class="total-price">
              <div class="price-breakdown">
                <div class="price-row">
                  <span class="price-label">قیمت کل:</span>
                  <span class="price-value">{{ (product.price * product.quantity) | currency:'IRR':'symbol':'1.0-0':'fa' }}</span>
                </div>
                <div class="price-row" *ngIf="product.discount > 0">
                  <span class="price-label">تخفیف ({{ product.discount }}%):</span>
                  <span class="price-value discount">{{ ((product.price * product.quantity * product.discount) / 100) | currency:'IRR':'symbol':'1.0-0':'fa' }}</span>
                </div>
                <div class="price-row final">
                  <span class="price-label">قیمت نهایی:</span>
                  <span class="price-value final">{{ calculateItemTotal(i) | currency:'IRR':'symbol':'1.0-0':'fa' }}</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Summary -->
    <div class="summary-section">
      <div class="summary-card">
        <h3 class="summary-title">خلاصه سفارش</h3>
        <div class="summary-details">
          <div class="summary-row">
            <span class="summary-label">تعداد کل کارت‌ها:</span>
            <span class="summary-value">{{ getTotalQuantity() }}</span>
          </div>
          <div class="summary-row">
            <span class="summary-label">قیمت کل (بدون تخفیف):</span>
            <span class="summary-value">{{ getTotalPrice() | currency:'IRR':'symbol':'1.0-0':'fa' }}</span>
          </div>
          <div class="summary-row" *ngIf="getTotalDiscount() > 0">
            <span class="summary-label">تخفیف کل:</span>
            <span class="summary-value discount">{{ getTotalDiscount() | currency:'IRR':'symbol':'1.0-0':'fa' }}</span>
          </div>
          <div class="summary-row total">
            <span class="summary-label">قیمت نهایی:</span>
            <span class="summary-value final">{{ getFinalPrice() | currency:'IRR':'symbol':'1.0-0':'fa' }}</span>
          </div>
          <div class="summary-savings" *ngIf="getTotalDiscount() > 0">
            <span class="savings-text">صرفه‌جویی: {{ getTotalDiscount() | currency:'IRR':'symbol':'1.0-0':'fa' }}</span>
          </div>
        </div>
        <div class="summary-actions">
          <button class="reset-btn" (click)="resetAll()">بازنشانی</button>
          <button class="order-btn" (click)="placeOrder()">ثبت سفارش</button>
        </div>
      </div>
    </div>

  </div>
</div>